// #include <Debug.h>
#include <AbstractTriangulation.h>

struct CellComplex : ttk::Debug {

  virtual ttk::SimplexId getNumberOfVertices() const {
    return 0;
  }
  virtual ttk::SimplexId getVertexNeighborNumber(ttk::SimplexId) const {
    return 0;
  }
  virtual void
    getVertexNeighbor(ttk::SimplexId, ttk::SimplexId, ttk::SimplexId &) const {
  }
  virtual void preconditionVertexNeighbors() {
  }
};

struct ImplicitFreudenthalTriangulation : CellComplex {

  ImplicitFreudenthalTriangulation(const std::array<ttk::SimplexId, 3> &dim_)
    : dim{dim_}, dimM1{dim_[0] - 1, dim_[1] - 1, dim_[2] - 1},
      dimM1F{static_cast<float>(dimM1[0]), static_cast<float>(dimM1[1]),
             static_cast<float>(dimM1[2])},
      dimXY{dim[0] * dim[1]}, offsetsLUT2{} {
    preconditionVertexNeighbors();
  }

  void setDimension(int *dim_) {
    dim = {dim_[0], dim_[1], dim_[2]};
    dimM1 = {dim_[0] - 1, dim_[1] - 1, dim_[2] - 1};
    dimM1F = std::array<float, 3>{static_cast<float>(dimM1[0]),
                                  static_cast<float>(dimM1[1]),
                                  static_cast<float>(dimM1[2])};
    dimXY = dim[0] * dim[1];

    preconditionVertexNeighbors();
  }

  ttk::SimplexId getNumberOfVertices() const final {
    return this->dim[0] * this->dim[1] * this->dim[2];
  }

  ttk::SimplexId getVertexNeighborNumber(ttk::SimplexId idx) const final {
    const auto key = voxelIndexToKey(linearToVoxelIndex(idx));
    return nNeighborsLUT[key];
  }

  ttk::SimplexId getVertexNeighbor(ttk::SimplexId idx,
                                   ttk::SimplexId neighborIndex) const {
    const auto key = voxelIndexToKey(linearToVoxelIndex(idx));
    return idx + offsetsLUT2[key * maxNeighbours + neighborIndex];
  }

  void getVertexNeighbor(ttk::SimplexId idx,
                         ttk::SimplexId n,
                         ttk::SimplexId &nIdx) const final {
    nIdx = getVertexNeighbor(idx, n);
  }

private:
  void preconditionVertexNeighbors() final {
    for(size_t i = 0; i < offsetsLUT.size(); i++) {
      const auto &d = offsetsLUT[i];

      offsetsLUT2[i] = d[0] + d[1] * this->dim[0] + d[2] * this->dimXY;
    }
  }

  std::array<ttk::SimplexId, 3> linearToVoxelIndex(ttk::SimplexId idx) const {
    const ttk::SimplexId z = idx / dimXY;
    const auto idx2 = idx - (z * dimXY);
    const ttk::SimplexId y = idx2 / dim[0];
    const ttk::SimplexId x = idx2 % dim[0];
    return {x, y, z};
  }

  int voxelIndexToKey(const std::array<ttk::SimplexId, 3> &index) const {
    return (index[0] == 0 ? 1 : (index[0] == dimM1[0] ? 2 : 0))
           + (index[1] == 0 ? 4 : (index[1] == dimM1[1] ? 8 : 0))
           + (index[2] == 0 ? 16 : (index[2] == dimM1[2] ? 32 : 0));
  }

  static constexpr std::array<ttk::SimplexId, 64> nNeighborsLUT{
    14, 10, 10, 0, 10, 6, 8, 0, 10, 8, 6,  0, 0, 0, 0, 0, 10, 6, 8, 0, 8, 4,
    7,  0,  6,  4, 4,  0, 0, 0, 0,  0, 10, 8, 6, 0, 6, 4, 4,  0, 8, 7, 4, 0,
    0,  0,  0,  0, 0,  0, 0, 0, 0,  0, 0,  0, 0, 0, 0, 0, 0,  0, 0, 0};
  static constexpr ttk::SimplexId maxNeighbours = 14;
  static constexpr std::array<std::array<ttk::SimplexId, 3>,
                              nNeighborsLUT.size() * maxNeighbours>
    offsetsLUT{{{0, -1, -1}, {1, -1, -1}, {0, 0, -1},  {1, 0, -1},  {0, -1, 0},
                {1, -1, 0},  {1, 0, 0},   {-1, 0, 1},  {0, 0, 1},   {-1, 0, 0},
                {-1, 1, 0},  {0, 1, 0},   {-1, 1, 1},  {0, 1, 1},   {0, -1, -1},
                {1, -1, -1}, {0, 0, -1},  {1, 0, -1},  {0, -1, 0},  {1, -1, 0},
                {1, 0, 0},   {0, 1, 0},   {0, 1, 1},   {0, 0, 1},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {-1, 0, 0},  {-1, 1, 0},
                {0, 1, 0},   {-1, 0, 1},  {0, 0, 1},   {-1, 1, 1},  {0, 1, 1},
                {0, 0, -1},  {0, -1, -1}, {0, -1, 0},  {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {-1, 0, 0},  {-1, 1, 0},  {0, 1, 0},   {-1, 0, 1},
                {0, 0, 1},   {-1, 1, 1},  {0, 1, 1},   {1, 0, 0},   {1, 0, -1},
                {0, 0, -1},  {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {1, 0, 0},   {0, 1, 0},   {0, 0, 1},   {0, 1, 1},   {0, 0, -1},
                {1, 0, -1},  {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {-1, 0, 0},
                {-1, 1, 0},  {0, 1, 0},   {-1, 0, 1},  {0, 0, 1},   {-1, 1, 1},
                {0, 1, 1},   {0, 0, -1},  {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, -1, -1}, {1, -1, -1}, {0, 0, -1},
                {1, 0, -1},  {0, -1, 0},  {1, -1, 0},  {1, 0, 0},   {-1, 0, 0},
                {-1, 0, 1},  {0, 0, 1},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, -1, -1}, {1, -1, -1}, {0, 0, -1},  {1, 0, -1},
                {0, -1, 0},  {1, -1, 0},  {1, 0, 0},   {0, 0, 1},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, -1, 0},  {-1, 0, 0},  {-1, 0, 1},  {0, 0, 1},   {0, -1, -1},
                {0, 0, -1},  {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {-1, 0, 0},
                {-1, 1, 0},  {0, 1, 0},   {-1, 0, 1},  {0, 0, 1},   {-1, 1, 1},
                {0, 1, 1},   {0, -1, 0},  {1, -1, 0},  {1, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, -1, 0},  {1, -1, 0},
                {1, 0, 0},   {0, 0, 1},   {0, 1, 0},   {0, 1, 1},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {-1, 0, 0},  {-1, 1, 0},  {0, 1, 0},
                {-1, 0, 1},  {0, 0, 1},   {-1, 1, 1},  {0, 1, 1},   {0, -1, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {-1, 0, 0},  {-1, 1, 0},  {0, 1, 0},   {-1, 0, 1},  {0, 0, 1},
                {-1, 1, 1},  {0, 1, 1},   {1, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {1, 0, 0},
                {0, 1, 0},   {0, 0, 1},   {0, 1, 1},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {-1, 0, 0},  {-1, 1, 0},
                {0, 1, 0},   {-1, 0, 1},  {0, 0, 1},   {-1, 1, 1},  {0, 1, 1},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, -1, 0},  {-1, 0, 0},  {-1, 0, 1},  {0, 0, 1},
                {1, -1, 0},  {1, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, -1, 0},  {1, -1, 0},  {1, 0, 0},   {0, 0, 1},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, -1, 0},
                {-1, 0, 0},  {-1, 0, 1},  {0, 0, 1},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, -1, -1}, {1, -1, -1},
                {0, 0, -1},  {1, 0, -1},  {0, -1, 0},  {1, -1, 0},  {1, 0, 0},
                {-1, 0, 0},  {-1, 1, 0},  {0, 1, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, -1, -1}, {1, -1, -1}, {0, 0, -1},
                {1, 0, -1},  {0, -1, 0},  {1, -1, 0},  {1, 0, 0},   {0, 1, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, -1},  {-1, 0, 0},  {-1, 1, 0},  {0, 1, 0},
                {0, -1, -1}, {0, -1, 0},  {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, -1},
                {-1, 0, 0},  {-1, 1, 0},  {0, 1, 0},   {1, 0, -1},  {1, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, -1},  {1, 0, -1},
                {1, 0, 0},   {0, 1, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, -1},  {-1, 0, 0},  {-1, 1, 0},
                {0, 1, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, -1, -1}, {1, -1, -1}, {0, 0, -1},  {1, 0, -1},  {0, -1, 0},
                {1, -1, 0},  {1, 0, 0},   {-1, 0, 0},  {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, -1, -1},
                {1, -1, -1}, {0, 0, -1},  {1, 0, -1},  {0, -1, 0},  {1, -1, 0},
                {1, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, -1, -1}, {0, 0, -1},
                {0, -1, 0},  {-1, 0, 0},  {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},   {0, 0, 0},
                {0, 0, 0}}};

  std::array<ttk::SimplexId, offsetsLUT.size() * maxNeighbours> offsetsLUT2;
  std::array<ttk::SimplexId, 3> dim;
  std::array<ttk::SimplexId, 3> dimM1;
  std::array<float, 3> dimM1F;
  ttk::SimplexId dimXY;
};
